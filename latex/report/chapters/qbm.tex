\section{Theory}
\subsection{A Fully Quantum Boltzmann Machine}
The Quantum Boltzmann Machine (QBM) detailed in this section is based on the work first presented in~\cite{amin_2018}.
The main change we make is that we start by detailing a restricted version of the QBM (QRBM), since having the restrictions as in the classical RBM simplifies the mathematics and allows for a more straight forward direct comparison.

We start with the idea of a classical Boltzmann machine and transform it to the language of quantum mechanics by converting the energy function to an Ising spin Hamiltonian with the first (last) \( n_v \ (n_h) \) qubits corresponding to the visible (hidden) units
\begin{align}
    H = -\sum_k c_k \sigma_k^z - \sum_{i,j} w_{ij} \sigma_i^z \sigma_j^z
\end{align}
where
\begin{align}
    \sigma_k^z
        &= I^{\otimes k-1} \otimes \sigma_z \otimes I^{\otimes N-k}
\end{align}
with \( \sigma_z \) being the Pauli \( z \) matrix, and \( I \) being the \( 2 \times 2 \) identity matrix.
To keep notation simple and easy to understand, we use the indices \( i = 1, \dots, n_v \) to represent visible units, \( j = n_v + 1, \dots, N \) to represent hidden units, and \( k = 1, \dots, N \) to represent all units.
We use the concatenated bias vector
\begin{align}
    \vec{c} = \begin{bmatrix}
        \vec{a} \\
        \vec{b}
    \end{bmatrix}
\end{align}
where \( \vec{a} \) and \( \vec{b} \) are the bias vectors of the visible and hidden units, respectively.

To model the probabilities of the states we use the density operator
\begin{align}
    \rho = \frac{1}{Z} e^{-H}
\end{align}
where \( e^{-H} = \sum_n \frac{1}{n!} (-H)^n \) is the matrix exponential, and the partition function is given by \( Z = \tr(e^{-H}) \).
The probability to find the system in state \( \ket{\vec{v},\vec{h}} \) is given by
\begin{align}
    p(\vec{v},\vec{h})
        &= \tr(\ket{\vec{v},\vec{h}}\bra{\vec{v},\vec{h}} \rho)
\end{align}
and if we define the projection operator
\begin{align}
    \Lambda_\vec{v} = \ket{\vec{v}}\bra{\vec{v}} \otimes I^{\otimes n_h}
\end{align}
then the marginal probability to measure the visible units in state \( \ket{\vec{v}} \) is given by
\begin{align}
    p(\vec{v}) = \tr(\Lambda_{\vec{v}}\rho)
\end{align}

Using the probabilities above we can obtain an average log-likelihood, which for data distribution \( p_\text{data} \) and parameters \( \theta = (\mat{W}, \vec{a}, \vec{b}) \) is given by
\begin{align}
    \ell(\theta) = \sum_{\vec{v}} p_{\text{data}}(\vec{v}) \log \tr(\Lambda_\vec{v}\rho)
\end{align}

To optimize the model, it is preferable to maximize the lower bound of the log-likelihood (in practice this is done by minimizing the upper bound of the negative log-likelihood) rather than maximizing the log-likelihood itself.
The reason for this is that the partial derivative of the log-likelihood w.r.t.\ the parameters has a term which is nontrivial to compute (see \cref{app:qbm_log_likelihood_derivation} for more info).
The lower bound of the log-likelihood is given by (see \cref{app:qbm_log_likelihood_lower_bound} for how one arrives at this result)
\begin{align}
    \tilde{\ell}(\theta) = \sum_{\vec{v}} p_{\text{data}}(\vec{v}) \log \tr(\Lambda_\vec{v}\rho_\vec{v})
\end{align}
where we have what is referred to as the "clamped" Hamiltonian, which for a given visible vector \( \vec{v} \) is
\begin{align}
    H_\vec{v}
        &= \braket{\vec{v}|H|\vec{v}}
\end{align}
with corresponding clamped density matrix
\begin{align}
    \rho_\vec{v}
        &= \frac{1}{Z_\vec{v}} e^{-H_\vec{v}}
\end{align}
and \( Z_\vec{v} = \tr(e^{-H_\vec{v}}) \).

The associated derivatives w.r.t.\ the parameters of the lower bound are given by (see \cref{app:qbm_log_likelihood_lower_bound_derivative} for derivation)
\begin{align}
    \partial_{w_{ij}} \tilde{\ell}(\theta)
        &= \overline{\langle \sigma_i^z \sigma_j^z \rangle_\vec{v}} - \langle \sigma_i^z \sigma_j^z \rangle \\
    \partial_{c_k} \tilde{\ell}(\theta)
        &= \overline{\langle \sigma_k^z \rangle_\vec{v}} - \langle \sigma_k^z \rangle
\end{align}
where \( \langle \ \cdot \ \rangle_\vec{v} = \tr(\cdot \rho_\vec{v}) \) is the expectation value w.r.t.\ the clamped density matrix and \( \langle \ \cdot \ \rangle = \tr(\cdot \rho) \) is the expectation value w.r.t\ the regular density matrix.
\begin{align}
    \langle \sigma_i^z \rangle_\vec{v}
        &= v_i \\
    \langle \sigma_j^z \rangle_\vec{v}
        &= \frac{c_j'(\vec{v})}{D_j(\vec{v})} \tanh\big(D_j(\vec{v})\big) \\
    \langle \sigma_i^z \sigma_j^z \rangle_{\vec{v}}
        &= v_i \frac{c_j'(\vec{v})}{D_j(\vec{v})} \tanh\big(D_j(\vec{v})\big)
\end{align}
where \( D_j(\vec{v}) = \sqrt{\Gamma_j^2 + \big(c_j'(\vec{v})\big)^2} \).


\todo{Quantum annealing theory}

\todo{Explain QUBO}

\section{Application}
\todo{D-Wave introduction/usage}

\section{Results}
