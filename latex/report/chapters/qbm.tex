\section{Theory}
\subsection{A Fully Quantum Boltzmann Machine}
The Quantum Boltzmann Machine (QBM) detailed in this section is based on the work first presented in~\cite{amin_2018}.
The main change we make is that we start by detailing a restricted version of the QBM (QRBM), since having the restrictions as in the classical RBM simplifies the mathematics and allows for a more straight forward direct comparison.

We can start with the idea of a classical Boltzmann machine and transform it to the language of quantum mechanics by converting the energy function to an Ising spin Hamiltonian (here we separate the terms of the visible and hidden layers to make it closer resemble the form of the classical RBM's energy)
\begin{align}
    H = -\sum_i a_i \sigma_i^z - \sum_j b_j \sigma_j^z - \sum_{i,j} w_{ij} \sigma_i^z \sigma_j^z
\end{align}
where
\begin{align}
    \sigma_i^z
        &= I^{\otimes i-1} \otimes \sigma_z \otimes I^{\otimes N-i}
\end{align}
with \( \sigma_z \) being the Pauli \( z \) matrix, and \( I \) being the \( 2 \times 2 \) identity matrix.
For convenience we use similar notation as in the classical RBM case, where \( i \) indices correspond to visible units and \( j \) indices correspond to hidden units.
Therefore, one must take note that \( \sigma_j \) actually has an index offset of \( n_v \) since the preceding visible units need to be accounted for in the tensor product.

Because the language of quantum mechanics deals in the values \( -1 \) and \( +1 \) (stemming from the eigenvalues of the Pauli matrices) rather than \( 0 \) and \( 1 \), we will keep the vectors \( \vec{v} \in \Z_2^{n_v} \) and \( \vec{h} \in \Z_2^{n_h} \) and define the vectors \( \tilde{\vec{v}} = 2\vec{v} - \vec{1} \in \{-1,+1\}^{n_v} \) and \( \tilde{\vec{h}} = 2\vec{h} - \vec{1} \in \{-1,+1\}^{n_h} \) to represent the binary vectors in the quantum realm.

To model the probabilities of the states we use the density operator
\begin{align}
    \rho = \frac{1}{Z} e^{-H}
\end{align}
where \( e^{-H} = \sum_k \frac{1}{k!} (-H)^k \) is the matrix exponential, and the partition function is given by \( Z = \tr(e^{-H}) \).
The probability to find the system in state \( \ket{\vec{v},\vec{h}} \) is given by
\begin{align}
    p(\vec{v},\vec{h})
        &= \tr(\ket{\vec{v},\vec{h}}\bra{\vec{v},\vec{h}} \rho)
\end{align}
and if we define the projection operator
\begin{align}
    \Lambda_\vec{v} = \ket{\vec{v}}\bra{\vec{v}} \otimes I^{\otimes n_h}
\end{align}
then the marginal probability to measure the visible units in state \( \ket{\vec{v}} \) is given by
\begin{align}
    p(\vec{v}) = \tr(\Lambda_{\vec{v}}\rho)
\end{align}

Using the probabilities above we can obtain an average log-likelihood, which for data distribution \( p_\text{data} \) and parameters \( \theta = (\mat{W}, \vec{a}, \vec{b}) \) is given by
\begin{align}
    \ell(\theta) = \sum_{\vec{v}} p_{\text{data}}(\vec{v}) \log \tr(\Lambda_\vec{v}\rho)
\end{align}

To optimize the model, it is preferable to maximize the lower bound of the log-likelihood (in practice this is done by minimizing the upper bound of the negative log-likelihood) rather than maximizing the log-likelihood itself.
The reason for this is that the partial derivative of the log-likelihood w.r.t.\ the parameters has a term which is nontrivial to compute (see \cref{app:qbm_log_likelihood_derivation} for more info).
The lower bound of the log-likelihood is given by (see \cref{app:qbm_log_likelihood_lower_bound} for how one arrives at this result)
\begin{align}
    \tilde{\ell}(\theta) = \sum_{\vec{v}} p_{\text{data}}(\vec{v}) \log \tr(\Lambda_\vec{v}\rho_\vec{v})
\end{align}
where what is referred to as the "clamped" Hamiltonian, which for a given visible vector \( \vec{v} \) is
\begin{align}
    H_\vec{v}
        &= \braket{\vec{v}|H|\vec{v}}
\end{align}
with corresponding clamped density matrix
\begin{align}
    \rho_\vec{v}
        &= \frac{1}{Z_\vec{v}} e^{-H_\vec{v}}
\end{align}
and \( Z_\vec{v} = \tr(e^{-H_\vec{v}}) \).

The associated derivatives w.r.t.\ the parameters of the lower bound are given by (see \cref{app:qbm_log_likelihood_lower_bound_derivative} for derivation)
\begin{align}
    \partial_{w_{ij}} \tilde{\ell}(\theta)
        &= \overline{\langle \sigma_i^z \sigma_j^z \rangle_\vec{v}} - \langle \sigma_i^z \sigma_j^z \rangle \\
    \partial_{a_i} \tilde{\ell}(\theta)
        &= \overline{\langle \sigma_i^z \rangle_\vec{v}} - \langle \sigma_i^z \rangle \\
    \partial_{b_j} \tilde{\ell}(\theta)
        &= \overline{\langle \sigma_j^z \rangle_\vec{v}} - \langle \sigma_j^z \rangle
\end{align}
where \( \langle \ \cdot \ \rangle_\vec{v} = \tr(\cdot \rho_\vec{v}) \) is the expectation value w.r.t.\ the clamped density matrix and \( \langle \ \cdot \ \rangle = \tr(\cdot \rho) \) is the expectation value w.r.t\ the regular density matrix.
\begin{align}
    \langle \sigma_j^z \rangle_\vec{v}
        &= \frac{b_j'(\tilde{\vec{v}})}{D_j(\tilde{\vec{v}})} \tanh(D_j) \\
    \langle \sigma_i^z \rangle_\vec{v}
        &= \tilde{v}_i \\
    \langle \sigma_i^z \sigma_j^z \rangle_{\vec{v}}
        &= \tilde{v}_i \frac{b_j'(\tilde{\vec{v}})}{D_j(\tilde{\vec{v}})} \tanh(D_j)
\end{align}
where \( D_j(\tilde{\vec{v}}) = \sqrt{\Gamma_j^2 + \big(b_j'(\tilde{\vec{v}})\big)^2} \).


\todo{Quantum annealing theory}

\todo{Explain QUBO}

\section{Application}
\todo{D-Wave introduction/usage}

\section{Results}
